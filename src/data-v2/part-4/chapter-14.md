# Глава 14. Display, визуальное поведение элементов и позиционирование

CSS не только про внешность. Это язык для управления поведением элементов. Понимание display и позиционирования критично для создания предсказуемых и гибких макетов.

---

## 14.1. Display: как элемент ведёт себя по умолчанию

Display определяет, как элемент участвует в потоке документа и как его дочерние элементы располагаются.

### `display: block`

**Характеристики:**

- занимает всю строку
- начинается с новой строки
- можно задавать width/height
- можно задавать margin-top / bottom
- вертикальные margin'ы работают

**Примеры:** div, section, p, h1-h6, ul, ol.

**Поведение:**

```css
.block {
  display: block;
  width: 200px;
  height: 100px;
  margin: 20px; /* Все стороны */
}
```

### `display: inline`

**Характеристики:**

- не начинает новую строку
- игнорирует width/height
- реагирует только на горизонтальные margin/padding
- вертикальные margin/padding не влияют на layout соседей
- выстраивается в строку

**Примеры:** span, a, strong, em, code.

**Поведение:**

```css
.inline {
  display: inline;
  width: 200px; /* Игнорируется! */
  height: 100px; /* Игнорируется! */
  margin: 20px; /* Только горизонтальные работают */
}
```

### `display: inline-block`

Середина между inline и block:

- стоит в строке (как inline)
- можно задавать размеры (как block)
- вертикальные margin/padding работают

**Использование:**

```css
.inline-block {
  display: inline-block;
  width: 200px; /* Работает! */
  height: 100px; /* Работает! */
  margin: 20px; /* Все стороны работают */
}
```

**Когда использовать:**

- Кнопки в строке с фиксированными размерами
- Иконки с текстом
- Элементы, которые должны быть в строке, но с размерами

### `display: none`

Полностью исключает элемент из рендера, layout и событий. С точки зрения браузера такой элемент не существует.

```css
.hidden {
  display: none; /* Элемент не существует */
}
```

**Отличие от `visibility: hidden`:**

- `display: none` — элемент полностью удаляется из DOM-потока
- `visibility: hidden` — элемент занимает место, но невидим

### Другие значения display

**`display: flex`** — Flexbox контейнер

**`display: grid`** — Grid контейнер

**`display: table`** — Табличное поведение (устаревший подход для layout)

**`display: contents`** — Элемент «исчезает», его дети становятся детьми родителя

---

## 14.2. Позиционирование

Понимание позиционирования — ключ к грамотной вёрстке. Позиционирование — не магия, а строгая иерархия контекстов.

**Типы:**

### 1. `position: static` (по умолчанию)

Элемент следует нормальному потоку документа.

```css
.static {
  position: static; /* По умолчанию */
  top: 10px; /* Игнорируется */
  left: 10px; /* Игнорируется */
}
```

### 2. `position: relative`

Смещение относительно собственных координат. Сохраняет место в потоке, но позволяет смещать элемент относительно самого себя.

```css
.relative {
  position: relative;
  top: 10px; /* Смещение вниз на 10px */
  left: 20px; /* Смещение вправо на 20px */
}
```

**Важно:** Элемент сохраняет своё место в потоке, другие элементы не «сдвигаются».

**Использование:**

- Создание контекста позиционирования для absolute элементов
- Тонкая настройка расположения
- Смещение без влияния на другие элементы

### 3. `position: absolute`

Относительно ближайшего positioned ancestor. Удаляется из потока. Контекст позиционирования ищется вверх по дереву: первый элемент с position отличным от static. Если такого нет → relative к viewport.

```css
.parent {
  position: relative; /* Контекст позиционирования */
}

.child {
  position: absolute;
  top: 0;
  right: 0; /* В правом верхнем углу родителя */
}
```

**Характеристики:**

- Удаляется из потока документа
- Не занимает место
- Позиционируется относительно ближайшего positioned родителя
- Если positioned родителя нет — относительно viewport

**Использование:**

- Модальные окна
- Выпадающие меню
- Иконки-бейджи
- Накладывающиеся элементы

### 4. `position: fixed`

Относительно viewport. Фиксируется относительно viewport. Не зависит от прокрутки. Используется для шапок, кнопок «вверх», модальных оверлеев.

```css
.fixed {
  position: fixed;
  top: 0;
  left: 0; /* В левом верхнем углу viewport */
  width: 100%;
  z-index: 1000;
}
```

**Характеристики:**

- Всегда относительно viewport
- Не зависит от прокрутки
- Удаляется из потока
- Недостаток: внутри скролл-контейнеров fixed игнорирует родительский scroll

**Использование:**

- Липкие шапки/футеры
- Кнопки «наверх»
- Модальные оверлеи
- Боковые панели

### 5. `position: sticky`

Гибрид relative и fixed. Одна из самых полезных фишек современного CSS. Элемент ведёт себя так: пока внутри родителя → relative, когда достигает указанной позиции → fixed.

```css
.sticky {
  position: sticky;
  top: 0; /* Прилипает к верху при прокрутке */
  z-index: 100;
}
```

**Характеристики:**

- Ведёт себя как relative до достижения порога
- После достижения порога ведёт себя как fixed
- Работает только внутри родительского контейнера
- Требует указания top/bottom/left/right

**Использование:**

- Липкие заголовки таблиц
- Липкая навигация
- Липкие сайдбары

**Пример:**

```css
header {
  position: sticky;
  top: 0;
  background: white;
  z-index: 100;
}
```

---

## 14.3. z-index и контекст наложения

z-index контролирует порядок наложения элементов. Работает только для positioned элементов (relative, absolute, fixed, sticky).

**Правила:**

- Большее значение = выше
- Работает только в рамках одного контекста наложения
- Каждый positioned элемент создаёт новый контекст

**Пример:**

```css
.layer-1 {
  position: relative;
  z-index: 1;
}

.layer-2 {
  position: relative;
  z-index: 2; /* Выше layer-1 */
}

.layer-3 {
  position: absolute;
  z-index: 10; /* Выше всех, если в том же контексте */
}
```

**Контекст наложения:**

Каждый positioned элемент с z-index создаёт новый контекст. Дочерние элементы не могут «выйти» за пределы контекста родителя.

```css
.parent {
  position: relative;
  z-index: 1; /* Создаёт контекст */
}

.child {
  position: absolute;
  z-index: 999; /* Всё равно ниже элементов с z-index: 2 вне родителя */
}
```

---

## 14.4. Визуальное поведение элементов

### Overflow

Контролирует поведение контента, выходящего за границы элемента.

**Значения:**

- `overflow: visible` — контент виден (по умолчанию)
- `overflow: hidden` — контент обрезается
- `overflow: scroll` — всегда показываются полосы прокрутки
- `overflow: auto` — полосы прокрутки появляются при необходимости

```css
.container {
  width: 200px;
  height: 200px;
  overflow: auto; /* Прокрутка при необходимости */
}
```

### Visibility

Контролирует видимость элемента.

- `visibility: visible` — видим (по умолчанию)
- `visibility: hidden` — невидим, но занимает место
- `visibility: collapse` — для таблиц

**Отличие от display: none:**

- `visibility: hidden` — элемент занимает место в layout
- `display: none` — элемент полностью удаляется из layout

### Opacity

Контролирует прозрачность элемента.

```css
.transparent {
  opacity: 0.5; /* 50% прозрачности */
}

.invisible {
  opacity: 0; /* Невидим, но занимает место и реагирует на события */
}
```

**Отличие от visibility:**

- `opacity: 0` — элемент невидим, но реагирует на события
- `visibility: hidden` — элемент невидим и не реагирует на события

---

## 14.5. Float (устаревший подход)

Float изначально был для обтекания текста изображениями, но использовался для layout до появления Flexbox/Grid.

**Значения:**

- `float: left` — элемент прижимается к левому краю
- `float: right` — элемент прижимается к правому краю
- `float: none` — без float (по умолчанию)

**Проблемы:**

- Элемент выходит из потока
- Требует clearfix
- Сложно управлять
- Не адаптивен

**Современная практика:**

Не использовать float для layout. Использовать Flexbox или Grid.

---

## Вопросы на собеседовании

### 1. В чём разница между static / relative / absolute / fixed / sticky?

- static — нормальный поток
- relative — смещение относительно себя, место в потоке сохраняется
- absolute — относительно positioned ancestor, удаляется из потока
- fixed — относительно viewport, не зависит от прокрутки
- sticky — гибрид relative и fixed, прилипает при достижении порога

### 2. Чем display: none отличается от visibility: hidden?

display: none — элемент полностью удаляется из DOM-потока. visibility: hidden — элемент занимает место, но невидим.

### 3. Что такое контекст позиционирования?

Ближайший родительский элемент с position отличным от static. Для absolute элементов это точка отсчёта.

### 4. Как работает z-index?

Контролирует порядок наложения positioned элементов. Работает только в рамках одного контекста наложения.

### 5. Чем inline отличается от inline-block?

inline — нельзя задавать width/height, только горизонтальные margin/padding. inline-block — можно задавать размеры, все margin/padding работают, но элемент в строке.

### 6. Когда использовать position: sticky?

Для элементов, которые должны «прилипать» при прокрутке: заголовки таблиц, навигация, сайдбары.

### 7. Почему float устарел?

Сложен в управлении, требует clearfix, не адаптивен. Заменён Flexbox и Grid.
