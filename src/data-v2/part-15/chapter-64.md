# Глава 64. Evolution Design (ED)

Evolution Design — это не набор догм, а путь развития от малого к сложному. Главный принцип: **«Everything is a Trade-off»** (всё есть компромисс). Вы не внедряете FSD в лендинг, но закладываете возможность его внедрения позже.

---

## 64.1. Философия прагматизма

Evolution Design основан на идее, что архитектура должна **эволюционировать** вместе с проектом, а не навязываться с самого начала.

**Ключевые принципы:**

- **Постепенность** — архитектура растёт вместе с бизнес-требованиями
- **Прагматизм** — не нужно проектировать «космолет» на старте
- **Гибкость** — можно начать с простого и усложнять по мере необходимости

**Пример:** для лендинга не нужен FSD, но структура должна позволять легко перейти к FSD, когда проект вырастет.

---

## 64.2. Ключевые ценности

### 1. Постепенность

Архитектура растёт вместе с бизнес-требованиями. Не нужно проектировать «космолет» на старте.

**Пример эволюции:**

```
Этап 1: Лендинг
src/
├── components/
├── pages/
└── utils/

Этап 2: Добавили каталог
src/
├── features/
│   └── catalog/
├── components/
├── pages/
└── utils/

Этап 3: Выросли до FSD
src/
├── app/
├── pages/
├── features/
├── entities/
├── shared/
└── widgets/
```

### 2. Стандартизация (Единый язык)

ED вводит общие паттерны, чтобы разработчик мог легко переключиться между проектами, понимая, где искать логику, а где UI.

**Единые соглашения:**

- `features/` — законченные части функционала
- `entities/` — бизнес-сущности
- `shared/` — переиспользуемый код
- `hooks/` — кастомные хуки
- `api/` — API-слой

**Преимущество:** новый разработчик быстро понимает структуру проекта.

### 3. Понятность важнее сложности

Лучше написать простой код, который легко переписать, чем сложную абстракцию, которую никто не поймёт.

**Пример:**

```typescript
// ❌ Сложная абстракция
class DataFetcherFactory {
  createStrategy(type: string) {
    return new StrategyRegistry().get(type).build()
  }
}

// ✅ Простой код
function fetchUsers() {
  return apiClient.get('/users')
}
```

**Правило:** если абстракция не даёт явной пользы — не создавайте её.

---

## 64.3. Уровни применения

### Для новичков: Best Practices

Следование готовым гайдам (Best Practices) обеспечивает «достаточно качественную» архитектуру без глубоких знаний.

**Что делать:**

- Следовать структуре папок из документации
- Использовать готовые паттерны (FSD, Clean Architecture)
- Не изобретать велосипед

**Пример:** начать с простой структуры `components/`, `pages/`, `utils/`, а не сразу внедрять FSD.

### Для экспертов: Понимание принципов

Понимание принципов (DRY, SOLID, DDD) позволяет осознанно модифицировать паттерны под конкретную задачу проекта.

**Что делать:**

- Анализировать требования проекта
- Выбирать паттерны под задачу
- Модифицировать стандартные подходы при необходимости

**Пример:** для небольшого проекта можно упростить FSD, убрав слой `widgets/`, если он не нужен.

---

## 64.4. Эволюция структуры проекта

### Этап 1: Простой проект (1-3 страницы)

```
src/
├── components/
│   ├── Button.tsx
│   └── Input.tsx
├── pages/
│   ├── HomePage.tsx
│   └── AboutPage.tsx
└── utils/
    └── formatDate.ts
```

**Характеристики:**

- Минимум абстракций
- Всё в одном месте
- Быстрая разработка

### Этап 2: Средний проект (5-10 страниц, несколько фич)

```
src/
├── features/
│   ├── auth/
│   │   ├── components/
│   │   ├── hooks/
│   │   └── api/
│   └── products/
│       ├── components/
│       ├── hooks/
│       └── api/
├── shared/
│   ├── components/
│   └── utils/
└── pages/
```

**Характеристики:**

- Появились фичи
- Общий код вынесен в `shared/`
- Структура ещё простая

### Этап 3: Большой проект (FSD)

```
src/
├── app/
├── pages/
├── features/
├── entities/
├── shared/
└── widgets/
```

**Характеристики:**

- Полная структура FSD
- Чёткое разделение слоёв
- Сложная архитектура оправдана

---

## 64.5. Когда что использовать

### Когда НЕ нужен FSD

- **Лендинг** — простая структура `components/`, `pages/`
- **Портфолио** — минимум абстракций
- **Прототип** — быстрота важнее структуры

### Когда нужен FSD

- **Крупное приложение** — много фич, команда разработчиков
- **Долгосрочный проект** — нужна масштабируемость
- **Сложная бизнес-логика** — требуется чёткое разделение слоёв

### Когда нужен упрощённый FSD

- **Средний проект** — можно убрать слой `widgets/`
- **Небольшая команда** — упростить структуру для скорости
- **Переходный период** — постепенный переход к FSD

---

## 64.6. Практические примеры

### Пример 1: Начало проекта

**Задача:** создать лендинг для продукта.

**Решение:** простая структура без FSD:

```
src/
├── components/
│   ├── Header.tsx
│   ├── Footer.tsx
│   └── Hero.tsx
├── pages/
│   └── HomePage.tsx
└── styles/
```

**Почему:** FSD избыточен для лендинга, простая структура быстрее.

### Пример 2: Рост проекта

**Задача:** добавили каталог товаров и корзину.

**Решение:** вводим `features/`:

```
src/
├── features/
│   ├── catalog/
│   │   ├── components/
│   │   └── hooks/
│   └── cart/
│       ├── components/
│       └── hooks/
├── components/
└── pages/
```

**Почему:** фичи изолированы, но полный FSD ещё не нужен.

### Пример 3: Крупный проект

**Задача:** проект вырос, команда увеличилась.

**Решение:** полный FSD:

```
src/
├── app/
├── pages/
├── features/
├── entities/
├── shared/
└── widgets/
```

**Почему:** нужна чёткая структура для масштабирования и работы команды.

---

## 64.7. Миграция между этапами

### Как перейти от простой структуры к FSD

**Шаг 1:** Выделить фичи

```typescript
// Было
src/components/ProductCard.tsx

// Стало
src/features/products/components/ProductCard.tsx
```

**Шаг 2:** Выделить сущности

```typescript
// Было
src/features/products/types.ts

// Стало
src/entities/product/types.ts
```

**Шаг 3:** Создать слой widgets (если нужен)

```typescript
// Было
src/pages/HomePage.tsx (использует фичи напрямую)

// Стало
src/widgets/ProductList/
src/pages/HomePage.tsx (использует виджет)
```

**Важно:** миграция должна быть постепенной, не нужно переписывать всё сразу.

---

## 64.8. Best Practices

### 1. Начинайте с простого

Не внедряйте сложную архитектуру «на будущее». Начните с простой структуры и усложняйте по мере необходимости.

### 2. Рефакторинг — это нормально

Рефакторинг структуры проекта — нормальный процесс. Не бойтесь переименовывать папки и перемещать файлы.

### 3. Документируйте решения

Если вы отклонились от стандартного подхода — задокументируйте почему. Это поможет команде понять решение.

### 4. Следите за метриками

Отслеживайте, как структура влияет на скорость разработки. Если структура замедляет — упростите её.

---

## Вопросы на собеседовании

### 1. Что такое Evolution Design?

Подход к архитектуре, при котором структура проекта эволюционирует вместе с требованиями, а не навязывается с самого начала.

### 2. Когда использовать FSD, а когда простую структуру?

FSD — для крупных проектов с командой. Простая структура — для лендингов, прототипов, небольших проектов.

### 3. Как мигрировать от простой структуры к FSD?

Постепенно: сначала выделить фичи, потом сущности, затем виджеты (если нужны).

### 4. В чём разница между ED и FSD?

FSD — конкретная методология. ED — философия постепенного развития архитектуры, которая может использовать FSD на определённом этапе.

### 5. Как понять, что пора усложнять структуру?

Когда структура начинает мешать разработке: сложно найти файлы, много дублирования, команда путается в организации кода.
