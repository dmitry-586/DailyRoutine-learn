# Глава 1. Как браузер загружает страницу: URL, DNS, соединение, первый байт

Интернет кажется магией: ты вводишь в адресной строке "google.com" — и через долю секунды видишь страницу. На самом деле внутри происходит цепочка процессов, в которой задействованы десятки машин, протоколов и уровней. Если эту цепочку разложить по шагам, весь фронтенд становится куда логичнее: рендеринг, производительность, ошибки сети, кэш, CORS, WebSockets — всё это перестаёт быть набором «фич» и начинает складываться в цельную картину.

Для фронтенд-разработчика важно понимать это достаточно глубоко, чтобы не относиться к сети как к «чёрному ящику», который либо «работает», либо «сломался». Это база для осмысленных решений в архитектуре и для взрослого разговора с бэкенд-разработчиками и DevOps.

- грамотно объяснять сетевые проблемы
- понимать задержки доставки данных
- диагностировать производительность
- понимать ограничения браузера
- уверенно отвечать на собеседованиях уровня Middle+

---

## 1.1. Архитектура сети

Когда разработчик открывает браузер и вводит URL — кажется, что «страница просто загружается». На самом деле за этим стоит сложная, многоуровневая архитектура:

- физические сети (оптика, медные кабели, беспроводные сети)
- провайдеры и магистральные маршрутизаторы
- протоколы передачи данных
- система адресации (IP)
- система доменных имён (DNS)
- стек TCP/IP
- протоколы прикладного уровня (HTTP, TLS, WebSocket и др.)

### Как устроен Интернет

Интернет — это не «глобальный сервер», а сеть сетей. Тысячи автономных систем (AS — Autonomous Systems) соединены между собой через протокол BGP.

Про автономные системы можно думать так: это крупные «острова» сети — сеть провайдера, сеть крупной компании, сеть дата-центров. Каждый такой «остров» управляется своей организацией и договаривается с другими островами, по каким маршрутам передавать трафик. Этими договорённостями и занимается BGP — протокол, который по сути является «системой навигации» всего Интернета.

**Условная модель:**

Ваш компьютер → Домашний роутер → Провайдер (ISP) → Магистральные маршрутизаторы → Дата-центр / Сервер / CDN

Каждый переход — это hop. Можно буквально представить: пакет данных как путешественник, который переезжает из одного города в другой через цепочку пересадок. Чем больше пересадок (hop), тем выше задержка (latency) и тем чувствительнее это для реального пользователя — особенно в играх, видеозвонках и интерактивных веб‑приложениях.

---

## 1.2. DNS, IP и первый байт

Когда пользователь вводит `https://example.com`, запускается цепочка сетевых операций.

### DNS — система доменных имён

DNS — это «телефонный справочник Интернета». Он превращает доменное имя в IP-адрес.

Важно понимать: браузер _никогда_ не работает напрямую с доменным именем. Для него существует только IP‑адрес. Домен — это человеческо‑читаемая оболочка вокруг сложных чисел. Поэтому любой запрос к новому домену почти всегда начинается с DNS‑разрешения.

**Процесс DNS-lookups:**

1. Браузер проверяет локальный кэш
2. Система (OS) проверяет свой кэш
3. Обращение к DNS-серверу провайдера
4. Если нет записи — запрос к корневому серверу
5. Дальше — к серверу зоны (.com)
6. Потом — к авторитетному серверу домена
7. Возвращается IP-адрес

Обычно на DNS уходит 20–120 мс, и это заметная часть пути запроса. В метриках это отражается в TTFB (Time To First Byte): даже если сервер очень быстрый, медленный DNS уже делает сайт субъективно «тяжёлым».

### IP — адресация в сети

IP-адрес — это «номер квартиры» в огромном доме Интернета.

**Примеры:**

- IPv4: `192.168.0.1`
- IPv6: `2001:db8::ff00:42:8329`

IPv6 решает проблему нехватки адресов и уменьшает количество hop.

На практике для фронтенд-разработчика важно не столько уметь читать IPv6‑адреса, сколько понимать: один и тот же домен может иметь несколько IP‑адресов (IPv4 и IPv6), а реальный сервер может быть за CDN или балансировщиком нагрузки. Поэтому «IP сервера» — это почти всегда не одна машина, а целый слой инфраструктуры.

---

## 1.3. Цикл запрос–ответ

Упрощённая цепочка:

1. Ввод URL
2. DNS запрос
3. Установление TCP/TLS
4. Отправка HTTP-запроса
5. Сервер формирует ответ
6. Клиент получает данные
7. Рендер страницы

Интервьюеры любят спрашивать: «Что происходит от момента, когда вы нажимаете Enter?»

---

## Вопросы на собеседовании

### 1. Опишите, что происходит, когда пользователь вводит URL в браузер

Короткий и хороший ответ:

1. Проверка кэша
2. DNS-резолв
3. TCP-handshake
4. TLS-handshake (если HTTPS)
5. HTTP-запрос → HTML
6. Парсинг HTML → DOM
7. Загрузка CSS/JS
8. Рендеринг

### 2. Что такое DNS и зачем он нужен?

DNS — система доменных имён, превращающая доменное имя в IP-адрес. Это «телефонный справочник Интернета».

### 3. Что такое TTFB?

Time To First Byte — время от отправки запроса до получения первого байта ответа. Включает DNS, TCP/TLS handshake и время обработки на сервере.
